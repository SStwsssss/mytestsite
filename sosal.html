<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Ð§Ð°Ñ‚</title>
  <style>
    body { font: 16px sans-serif; max-width: 600px; margin: 20px auto; }
    #chat { border: 1px solid #ccc; height: 300px; overflow-y: auto; padding: 10px; }
    #msg { width: 80%; padding: 8px; }
    #send { padding: 8px; }
  </style>
</head>
<body>

  <h2>ðŸ’¬ ÐœÐ¾Ð¹ Ñ‡Ð°Ñ‚</h2>
  <div id="chat"></div>
  <br>
  <input id="nick" placeholder="ÐÐ¸Ðº" maxlength="15"> 
  <input id="msg" placeholder="Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ" disabled>
  <button id="send" disabled>âž¤</button>

  <!-- Firebase SDK (Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Realtime Database) -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

  <script>
    // ðŸ”‘ Ð¨ÐÐ“ 1: Ð’Ð¡Ð¢ÐÐ’Ð¬ Ð¡Ð®Ð”Ð Ð¡Ð’ÐžÐ™ databaseURL (Ð¾ÑÑ‚Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð½Ðµ Ð½ÑƒÐ¶Ð½Ð¾!)
    const db = firebase.initializeApp({
      databaseURL: "https://my-chat-site-2d226-default-rtdb.firebaseio.com/"
    }).database();

    const chat = document.getElementById('chat');
    const nickInp = document.getElementById('nick');
    const msgInp = document.getElementById('msg');
    const sendBtn = document.getElementById('send');

    // Ð Ð°Ð·Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ð¾Ð»Ðµ Ð¿Ð¾ÑÐ»Ðµ Ð²Ð²Ð¾Ð´Ð° Ð½Ð¸ÐºÐ°
    nickInp.oninput = () => {
      const n = nickInp.value.trim();
      msgInp.disabled = !n;
      sendBtn.disabled = !n;
      if (n) msgInp.focus();
    };

    // ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ°
    sendBtn.onclick = send;
    msgInp.onkeypress = e => { if (e.key === 'Enter') send(); };

    function send() {
      const n = nickInp.value.trim();
      const m = msgInp.value.trim();
      if (!n || !m) return;
      db.ref('messages').push({ nick: n, text: m, ts: Date.now() });
      msgInp.value = '';
    }

    // ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹
    db.ref('messages').limitToLast(50).on('child_added', snap => {
      const { nick, text } = snap.val();
      const div = document.createElement('div');
      div.innerHTML = `<b>${nick}</b>: ${text}`;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
    });
  </script>

</body>
</html>
